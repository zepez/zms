# Z Media Server (zms)

## Packages

- *packages/common* shared utility functions.
- *packages/config-server* validates and provides type-safe interface for environment variables. This can only ever be used on the server to avoid leaking sensitive data.
- *packages/constant* contains values that are re-used multiple times, but do not change often and can not be environment variables.
- *packages/db* contains database schema and client management.
- *packages/scripts* has general scripts for project management.
- *packages/queue* is a bullmq for video transcoding using `ffmpeg`.
- *packages/web* is the Next.js server.


## Commands

| Command                   | Action                                    |
| ------------------------- | ----------------------------------------- |
| `nvm use`                 | Uses NVM to load the correct node version |
| `pnpm install`            | Install dependencies                      |
| `pnpm lint`               | Lint all `.ts` files                      |
| `pnpm clean`              | [Remove all generated artifacts](https://github.com/zepez/zms/blob/main/scripts/clean.sh)                               |
| `pnpm clean-turbo-cache`  | Removes `.turbo` directories only         |
| `pnpm commit`             | Run `gitmoji` CLI                         |
| `pnpm db:migrate`         | Run migrations scripts generated by `drizzle-kit`               |
| `pnpm db:create`          | Create embedded sqlite database in `/data/db`                         |
| `pnpm docker`             | Convenience command for `docker-compose up`                         |
| `pnpm dev`                | Start Next.js dev server on port 3000                        |
| `pnpm build`              | Build production-optimized server                      |
| `pnpm start`              | Start production-optimized server                      |

## Contributing

1. Ensure you have [nvm installed](https://github.com/nvm-sh/nvm).
   
   Run `nvm use` to ensure your environment is running the correct version of Node. 

2. Ensure that you have [pnpm installed](https://pnpm.io/installation). 

3. Check out a new branch with `git checkout -b your-initials/feature-name`. For example, `git checkout -b az/google-oauth`

4. Run `pnpm install`

5. Make any changes.

6. Stage changes with `git add .`

7. Commit changes with gitmoji cli by running `pnpm commit`
   
8. Push to origin and open a PR.